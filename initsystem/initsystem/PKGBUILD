# Maintainer: valr <valere dot monseur at ymail dot com>

pkgname=initsystem
pkgver=1.2.0
pkgrel=1
pkgdesc='an init system'
url='https://github.com/valr/initsystem'
license=('GPL')
install='initsystem.install'
groups=('initsystem')
arch=('i686' 'x86_64')
backup=('etc/rc.conf' 'etc/rc.local' 'etc/rc.shutdown.local' 'etc/rc.respawn')
depends=('busybox' 'kbd' 'kmod' 'initramfs')
source=('init-og.c'
        'rc'
        'rc.conf'
        'rc.local'
        'rc.respawn'
        'rc.shutdown'
        'rc.shutdown.local'
        'rc.subr'
        'rc.d.udev'
        'shutdown'
        'LICENSE')
md5sums=('b3cf734052c09ec4b558a3454e31e571'
         'd0bff838624de9e7e230fe8992ba1b7e'
         '5a3ecdc04eceaf20d4577a8260362956'
         '1deddd37535712bac2ab4bb4f7fa9a43'
         'e29a5c5846c5515cf659255d23094337'
         'f4510b5be701aad1a9217d79383d50c4'
         '441535fedcec16c2c10767c92c6d3b4a'
         '5abf5027dff356c9defee3e1e0964cd5'
         'c1877945b8d975ccfc87705e51d1af3d'
         'd3a43724d9c7150d8b4448e263f01ae2'
         '4641e94ec96f98fabc56ff9cc48be14b')

build() {
  cd "${srcdir}"

  cc -Wall -static -o init-og init-og.c
}

package() {

  # configuration

  install -D -m 644 "${srcdir}"/rc.conf "${pkgdir}"/etc/rc.conf

  # binaries

  install -D -m 755 "${srcdir}"/init-og           "${pkgdir}"/usr/bin/init-og
  install -D -m 755 "${srcdir}"/rc                "${pkgdir}"/etc/rc
  install -D -m 755 "${srcdir}"/rc.local          "${pkgdir}"/etc/rc.local
  install -D -m 755 "${srcdir}"/rc.respawn        "${pkgdir}"/etc/rc.respawn
  install -D -m 755 "${srcdir}"/rc.shutdown       "${pkgdir}"/etc/rc.shutdown
  install -D -m 755 "${srcdir}"/rc.shutdown.local "${pkgdir}"/etc/rc.shutdown.local
  install -D -m 755 "${srcdir}"/rc.subr           "${pkgdir}"/etc/rc.subr
  install -D -m 755 "${srcdir}"/rc.d.udev         "${pkgdir}"/etc/rc.d/udev
  install -D -m 755 "${srcdir}"/shutdown          "${pkgdir}"/usr/bin/shutdown

  cd "${pkgdir}"/usr/bin

  ln -s shutdown halt
  ln -s shutdown poweroff
  ln -s shutdown reboot

  # license

  install -D -m 644 "${srcdir}"/LICENSE "${pkgdir}"/usr/share/licenses/"${pkgname}"/LICENSE
}

# vim: set filetype=sh:
